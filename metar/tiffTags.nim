import tables
import strutils

#[
http://www.digitalpreservation.gov/formats/content/tiff_tags.shtml

You can grab the tags from the HTML table by following this procedure:
Save the page to a file, add jquery to it and add an id="thetable" to
the tab table. Then open the new file and run the following script in
the console window.

var allCells = $("#thetable td");
one = allCells.filter(":nth-child(1)")
two = allCells.filter(":nth-child(3)")
for (i = 0; i < one.length; i++) {
  t = $(one[i])
  t2 = $(two[i])
  t2 = t2.text().replace(/ /g, '_')
  t2 = t2.text().replace(|/|g, '_')
  console.log(t.text() + ': "' + t2 + '",')
}
]#

const tagToString = {
  254'u16: "NewSubfileType",
  255'u16: "SubfileType",
  256'u16: "ImageWidth",
  257'u16: "ImageLength",
  258'u16: "BitsPerSample",
  259'u16: "Compression",
  262'u16: "PhotometricInterpretation",
  263'u16: "Threshholding",
  264'u16: "CellWidth",
  265'u16: "CellLength",
  266'u16: "FillOrder",
  269'u16: "DocumentName",
  270'u16: "ImageDescription",
  271'u16: "Make",
  272'u16: "Model",
  273'u16: "StripOffsets",
  274'u16: "Orientation",
  277'u16: "SamplesPerPixel",
  278'u16: "RowsPerStrip",
  279'u16: "StripByteCounts",
  280'u16: "MinSampleValue",
  281'u16: "MaxSampleValue",
  282'u16: "XResolution",
  283'u16: "YResolution",
  284'u16: "PlanarConfiguration",
  285'u16: "PageName",
  286'u16: "XPosition",
  287'u16: "YPosition",
  288'u16: "FreeOffsets",
  289'u16: "FreeByteCounts",
  290'u16: "GrayResponseUnit",
  291'u16: "GrayResponseCurve",
  292'u16: "T4Options",
  293'u16: "T6Options",
  296'u16: "ResolutionUnit",
  297'u16: "PageNumber",
  301'u16: "TransferFunction",
  305'u16: "Software",
  306'u16: "DateTime",
  315'u16: "Artist",
  316'u16: "HostComputer",
  317'u16: "Predictor",
  318'u16: "WhitePoint",
  319'u16: "PrimaryChromaticities",
  320'u16: "ColorMap",
  321'u16: "HalftoneHints",
  322'u16: "TileWidth",
  323'u16: "TileLength",
  324'u16: "TileOffsets",
  325'u16: "TileByteCounts",
  326'u16: "BadFaxLines",
  327'u16: "CleanFaxData",
  328'u16: "ConsecutiveBadFaxLines",
  330'u16: "SubIFDs",
  332'u16: "InkSet",
  333'u16: "InkNames",
  334'u16: "NumberOfInks",
  336'u16: "DotRange",
  337'u16: "TargetPrinter",
  338'u16: "ExtraSamples",
  339'u16: "SampleFormat",
  340'u16: "SMinSampleValue",
  341'u16: "SMaxSampleValue",
  342'u16: "TransferRange",
  343'u16: "ClipPath",
  344'u16: "XClipPathUnits",
  345'u16: "YClipPathUnits",
  346'u16: "Indexed",
  347'u16: "JPEGTables",
  351'u16: "OPIProxy",
  400'u16: "GlobalParametersIFD",
  401'u16: "ProfileType",
  402'u16: "FaxProfile",
  403'u16: "CodingMethods",
  404'u16: "VersionYear",
  405'u16: "ModeNumber",
  433'u16: "Decode",
  434'u16: "DefaultImageColor",
  512'u16: "JPEGProc",
  513'u16: "JPEGInterchangeFormat",
  514'u16: "JPEGInterchangeFormatLength",
  515'u16: "JPEGRestartInterval",
  517'u16: "JPEGLosslessPredictors",
  518'u16: "JPEGPointTransforms",
  519'u16: "JPEGQTables",
  520'u16: "JPEGDCTables",
  521'u16: "JPEGACTables",
  529'u16: "YCbCrCoefficients",
  530'u16: "YCbCrSubSampling",
  531'u16: "YCbCrPositioning",
  532'u16: "ReferenceBlackWhite",
  559'u16: "StripRowCounts",
  700'u16: "XMP",
  18246'u16: "Image.Rating",
  18249'u16: "Image.RatingPercent",
  32781'u16: "ImageID",
  32932'u16: "Wang_Annotation",
  33421'u16: "CFARepeatPatternDim",
  33422'u16: "CFAPattern",
  33423'u16: "BatteryLevel",
  33432'u16: "Copyright",
  33434'u16: "ExposureTime",
  33437'u16: "FNumber",
  33445'u16: "MD_FileTag",
  33446'u16: "MD_ScalePixel",
  33447'u16: "MD_ColorTable",
  33448'u16: "MD_LabName",
  33449'u16: "MD_SampleInfo",
  33450'u16: "MD_PrepDate",
  33451'u16: "MD_PrepTime",
  33452'u16: "MD_FileUnits",
  33550'u16: "ModelPixelScaleTag",
  33723'u16: "IPTC_NAA",
  33918'u16: "INGR_Packet_Data_Tag",
  33919'u16: "INGR_Flag_Registers",
  33920'u16: "IrasB_Transformation_Matrix",
  33922'u16: "ModelTiepointTag",
  34016'u16: "Site",
  34017'u16: "ColorSequence",
  34018'u16: "IT8Header",
  34019'u16: "RasterPadding",
  34020'u16: "BitsPerRunLength",
  34021'u16: "BitsPerExtendedRunLength",
  34022'u16: "ColorTable",
  34023'u16: "ImageColorIndicator",
  34024'u16: "BackgroundColorIndicator",
  34025'u16: "ImageColorValue",
  34026'u16: "BackgroundColorValue",
  34027'u16: "PixelIntensityRange",
  34028'u16: "TransparencyIndicator",
  34029'u16: "ColorCharacterization",
  34030'u16: "HCUsage",
  34031'u16: "TrapIndicator",
  34032'u16: "CMYKEquivalent",
  34033'u16: "Reserved",
  34034'u16: "Reserved",
  34035'u16: "Reserved",
  34264'u16: "ModelTransformationTag",
  34377'u16: "Photoshop",
  34665'u16: "Exif_IFD",
  34675'u16: "InterColorProfile",
  34732'u16: "ImageLayer",
  34735'u16: "GeoKeyDirectoryTag",
  34736'u16: "GeoDoubleParamsTag",
  34737'u16: "GeoAsciiParamsTag",
  34850'u16: "ExposureProgram",
  34852'u16: "SpectralSensitivity",
  34853'u16: "GPSInfo",
  34855'u16: "ISOSpeedRatings",
  34856'u16: "OECF",
  34857'u16: "Interlace",
  34858'u16: "TimeZoneOffset",
  34859'u16: "SelfTimeMode",
  34864'u16: "SensitivityType",
  34865'u16: "StandardOutputSensitivity",
  34866'u16: "RecommendedExposureIndex",
  34867'u16: "ISOSpeed",
  34868'u16: "ISOSpeedLatitudeyyy",
  34869'u16: "ISOSpeedLatitudezzz",
  34908'u16: "HylaFAX_FaxRecvParams",
  34909'u16: "HylaFAX_FaxSubAddress",
  34910'u16: "HylaFAX_FaxRecvTime",
  36864'u16: "ExifVersion",
  36867'u16: "DateTimeOriginal",
  36868'u16: "DateTimeDigitized",
  37121'u16: "ComponentsConfiguration",
  37122'u16: "CompressedBitsPerPixel",
  37377'u16: "ShutterSpeedValue",
  37378'u16: "ApertureValue",
  37379'u16: "BrightnessValue",
  37380'u16: "ExposureBiasValue",
  37381'u16: "MaxApertureValue",
  37382'u16: "SubjectDistance",
  37383'u16: "MeteringMode",
  37384'u16: "LightSource",
  37385'u16: "Flash",
  37386'u16: "FocalLength",
  37387'u16: "FlashEnergy",
  37388'u16: "SpatialFrequencyResponse",
  37389'u16: "Noise",
  37390'u16: "FocalPlaneXResolution",
  37391'u16: "FocalPlaneYResolution",
  37392'u16: "FocalPlaneResolutionUnit",
  37393'u16: "ImageNumber",
  37394'u16: "SecurityClassification",
  37395'u16: "ImageHistory",
  37396'u16: "SubjectLocation",
  37397'u16: "ExposureIndex",
  37398'u16: "TIFF_EPStandardID",
  37399'u16: "SensingMethod",
  37500'u16: "MakerNote",
  37510'u16: "UserComment",
  37520'u16: "SubsecTime",
  37521'u16: "SubsecTimeOriginal",
  37522'u16: "SubsecTimeDigitized",
  37724'u16: "ImageSourceData",
  40091'u16: "XPTitle",
  40092'u16: "XPComment",
  40093'u16: "XPAuthor",
  40094'u16: "XPKeywords",
  40095'u16: "XPSubject",
  40960'u16: "FlashpixVersion",
  40961'u16: "ColorSpace",
  40962'u16: "PixelXDimension",
  40963'u16: "PixelYDimension",
  40964'u16: "RelatedSoundFile",
  40965'u16: "Interoperability_IFD",
  41483'u16: "FlashEnergy",
  41484'u16: "SpatialFrequencyResponse",
  41486'u16: "FocalPlaneXResolution",
  41487'u16: "FocalPlaneYResolution",
  41488'u16: "FocalPlaneResolutionUnit",
  41492'u16: "SubjectLocation",
  41493'u16: "ExposureIndex",
  41495'u16: "SensingMethod",
  41728'u16: "FileSource",
  41729'u16: "SceneType",
  41730'u16: "CFAPattern",
  41985'u16: "CustomRendered",
  41986'u16: "ExposureMode",
  41987'u16: "WhiteBalance",
  41988'u16: "DigitalZoomRatio",
  41989'u16: "FocalLengthIn35mmFilm",
  41990'u16: "SceneCaptureType",
  41991'u16: "GainControl",
  41992'u16: "Contrast",
  41993'u16: "Saturation",
  41994'u16: "Sharpness",
  41995'u16: "DeviceSettingDescription",
  41996'u16: "SubjectDistanceRange",
  42016'u16: "ImageUniqueID",
  42032'u16: "CameraOwnerName",
  42033'u16: "BodySerialNumber",
  42034'u16: "LensSpecification",
  42035'u16: "LensMake",
  42036'u16: "LensModel",
  42037'u16: "LensSerialNumber",
  42112'u16: "GDAL_METADATA",
  42113'u16: "GDAL_NODATA",
  48129'u16: "PixelFormat",
  48130'u16: "Transformation",
  48131'u16: "Uncompressed",
  48132'u16: "ImageType",
  48256'u16: "ImageWidth",
  48257'u16: "ImageHeight",
  48258'u16: "WidthResolution",
  48259'u16: "HeightResolution",
  48320'u16: "ImageOffset",
  48321'u16: "ImageByteCount",
  48322'u16: "AlphaOffset",
  48323'u16: "AlphaByteCount",
  48324'u16: "ImageDataDiscard",
  48325'u16: "AlphaDataDiscard",
  48132'u16: "ImageType",
  50215'u16: "Oce_Scanjob_Description",
  50216'u16: "Oce_Application_Selector",
  50217'u16: "Oce_Identification_Number",
  50218'u16: "Oce_ImageLogic_Characteristics",
  50341'u16: "PrintImageMatching",
  50706'u16: "DNGVersion",
  50707'u16: "DNGBackwardVersion",
  50708'u16: "UniqueCameraModel",
  50709'u16: "LocalizedCameraModel",
  50710'u16: "CFAPlaneColor",
  50711'u16: "CFALayout",
  50712'u16: "LinearizationTable",
  50713'u16: "BlackLevelRepeatDim",
  50714'u16: "BlackLevel",
  50715'u16: "BlackLevelDeltaH",
  50716'u16: "BlackLevelDeltaV",
  50717'u16: "WhiteLevel",
  50718'u16: "DefaultScale",
  50719'u16: "DefaultCropOrigin",
  50720'u16: "DefaultCropSize",
  50721'u16: "ColorMatrix1",
  50722'u16: "ColorMatrix2",
  50723'u16: "CameraCalibration1",
  50724'u16: "CameraCalibration2",
  50725'u16: "ReductionMatrix1",
  50726'u16: "ReductionMatrix2",
  50727'u16: "AnalogBalance",
  50728'u16: "AsShotNeutral",
  50729'u16: "AsShotWhiteXY",
  50730'u16: "BaselineExposure",
  50731'u16: "BaselineNoise",
  50732'u16: "BaselineSharpness",
  50733'u16: "BayerGreenSplit",
  50734'u16: "LinearResponseLimit",
  50735'u16: "CameraSerialNumber",
  50736'u16: "LensInfo",
  50737'u16: "ChromaBlurRadius",
  50738'u16: "AntiAliasStrength",
  50739'u16: "ShadowScale",
  50740'u16: "DNGPrivateData",
  50741'u16: "MakerNoteSafety",
  50778'u16: "CalibrationIlluminant1",
  50779'u16: "CalibrationIlluminant2",
  50780'u16: "BestQualityScale",
  50781'u16: "RawDataUniqueID",
  50784'u16: "Alias_Layer_Metadata",
  50827'u16: "OriginalRawFileName",
  50828'u16: "OriginalRawFileData",
  50829'u16: "ActiveArea",
  50830'u16: "MaskedAreas",
  50831'u16: "AsShotICCProfile",
  50832'u16: "AsShotPreProfileMatrix",
  50833'u16: "CurrentICCProfile",
  50834'u16: "CurrentPreProfileMatrix",
  50879'u16: "ColorimetricReference",
  50931'u16: "CameraCalibrationSignature",
  50932'u16: "ProfileCalibrationSignature",
  50933'u16: "ExtraCameraProfiles",
  50934'u16: "AsShotProfileName",
  50935'u16: "NoiseReductionApplied",
  50936'u16: "ProfileName",
  50937'u16: "ProfileHueSatMapDims",
  50938'u16: "ProfileHueSatMapData1",
  50939'u16: "ProfileHueSatMapData2",
  50940'u16: "ProfileToneCurve",
  50941'u16: "ProfileEmbedPolicy",
  50942'u16: "ProfileCopyright",
  50964'u16: "ForwardMatrix1",
  50965'u16: "ForwardMatrix2",
  50966'u16: "PreviewApplicationName",
  50967'u16: "PreviewApplicationVersion",
  50968'u16: "PreviewSettingsName",
  50969'u16: "PreviewSettingsDigest",
  50970'u16: "PreviewColorSpace",
  50971'u16: "PreviewDateTime",
  50972'u16: "RawImageDigest",
  50973'u16: "OriginalRawFileDigest",
  50974'u16: "SubTileBlockSize",
  50975'u16: "RowInterleaveFactor",
  50981'u16: "ProfileLookTableDims",
  50982'u16: "ProfileLookTableData",
  51008'u16: "OpcodeList1",
  51009'u16: "OpcodeList2",
  51022'u16: "OpcodeList3",
  51041'u16: "NoiseProfile",
  51089'u16: "OriginalDefaultFinalSize",
  51090'u16: "OriginalBestQualityFinalSize",
  51091'u16: "OriginalDefaultCropSize",
  51107'u16: "ProfileHueSatMapEncoding",
  51108'u16: "ProfileLookTableEncoding",
  51109'u16: "BaselineExposureOffset",
  51110'u16: "DefaultBlackRender",
  51111'u16: "NewRawImageDigest",
  51112'u16: "RawToPreviewGain",
  51125'u16: "DefaultUserCrop",
}.toOrderedTable


proc tagName*(tag: uint16): string =
  ## Return the name of the given tag or "" when not known.

  result = tagToString.getOrDefault(tag)
  if result == nil:
    result = ""

proc tagName*(tagString: string): string =
  ## Return the name of the given tag or "" when not known. The
  ## tagString parameter is a number string.

  try:
    let tag = (uint16)parseInt(tagString)
    return tagName(tag)
  except:
    return ""
